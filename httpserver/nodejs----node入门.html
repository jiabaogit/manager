<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="356"/>

<div>
<span><div style="text-align: left; margin-bottom: 48px; margin-top: -22px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;"><br/></span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">原文：</span></span><a href="http://www.nodebeginner.org/index-zh-cn.html">http://www.nodebeginner.org/index-zh-cn.html</a></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">一、nodejs 可以使javascript脱离浏览器运行，原理是nodejs使用了chorme的js引擎</span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;"><br/></span></span></div><div style="margin-left:40px;"><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">JavaScript最早是运行在浏览器中，然而浏览器只是提供了一个上下文，它定义了使用JavaScript可以做什么，但并没有“说”太多关于JavaScript语言本身可以做什么。事实上，JavaScript是一门“完整”的语言： 它可以使用在不同的上下文中，其能力与其他同类语言相比有过之而无不及。</span></span></div></div><div style="text-align: left; font-size: 18px; margin-bottom: 48px; margin-top: -22px; color: rgb(0, 0, 0); font-family: Georgia, serif; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;margin-left:40px;"><div>Node.js事实上就是另外一种上下文，它允许在后端（脱离浏览器环境）运行JavaScript代码。</div></div><div style="text-align: left; font-size: 18px; margin-bottom: 48px; margin-top: -22px; color: rgb(0, 0, 0); font-family: Georgia, serif; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;margin-left:40px;"><div>要实现在后台运行JavaScript代码，代码需要先被解释然后正确的执行。Node.js的原理正是如此，它使用了Google的V8虚拟机（Google的Chrome浏览器使用的JavaScript执行环境），来解释和执行JavaScript代码。</div></div><div style="text-align: left; font-size: 18px; margin-bottom: 48px; margin-top: -22px; color: rgb(0, 0, 0); font-family: Georgia, serif; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;margin-left:40px;"><div>除此之外，伴随着Node.js的还有许多有用的模块，它们可以简化很多重复的劳作，比如向终端输出字符串。</div></div><div style="text-align: left; margin-bottom: 48px; margin-top: -22px; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="margin-left:40px;"><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">因此，Node.js事实上既是一个运行时环境，同时又是一个库。</span></span></div><div style="margin-left:40px;"><span style="font-size: 18px;"><span style="font-family: Georgia, serif;"><br/></span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">二、nodejs自带http模块</span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">          require(&quot;http&quot;).createServer(回调函数A).listen();</span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">          A就是当有请求时会被调用的函数，俗称的回调</span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">          </span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">          简单的代码（server.js）<br/></span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">            </span></span><span style="font-size: 14px;"><span style="color: rgb(0, 0, 136);">var</span><span style="color: rgb(0, 0, 0);"> http </span><span style="color: rgb(102, 102, 0);">=</span><span style="color: rgb(0, 0, 0);"> require</span><span style="color: rgb(102, 102, 0);">(</span><span style="color: rgb(0, 136, 0);">&quot;http&quot;</span><span style="color: rgb(102, 102, 0);">);</span></span></div><div style="background-color: rgb(247, 247, 247); border: 1px solid rgb(238, 238, 238); padding: 16px; margin-bottom: 64px; margin-top: -24px; font-size: 14px; color: rgb(0, 0, 0); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="margin-left:40px;"><span style="color: rgb(0, 0, 0);"><br/></span></div><div style="margin-left:40px;"><span style="color: rgb(0, 0, 136);">function</span><span style="color: rgb(0, 0, 0);"> onRequest</span><span style="color: rgb(102, 102, 0);">(</span><span style="color: rgb(0, 0, 0);">request</span><span style="color: rgb(102, 102, 0);">,</span><span style="color: rgb(0, 0, 0);"> response</span><span style="color: rgb(102, 102, 0);">)</span><span style="color: rgb(0, 0, 0);"> </span><span style="color: rgb(102, 102, 0);">{</span></div><div style="margin-left:40px;"><span style="color: rgb(0, 0, 0);">  console</span><span style="color: rgb(102, 102, 0);">.</span><span style="color: rgb(0, 0, 0);">log</span><span style="color: rgb(102, 102, 0);">(</span><span style="color: rgb(0, 136, 0);">&quot;Request received.&quot;</span><span style="color: rgb(102, 102, 0);">);</span></div><div style="margin-left:40px;"><span style="color: rgb(0, 0, 0);">  response</span><span style="color: rgb(102, 102, 0);">.</span><span style="color: rgb(0, 0, 0);">writeHead</span><span style="color: rgb(102, 102, 0);">(</span><span style="color: rgb(0, 102, 102);">200</span><span style="color: rgb(102, 102, 0);">,</span><span style="color: rgb(0, 0, 0);"> </span><span style="color: rgb(102, 102, 0);">{</span><span style="color: rgb(0, 136, 0);">&quot;Content-Type&quot;</span><span style="color: rgb(102, 102, 0);">:</span><span style="color: rgb(0, 0, 0);"> </span><span style="color: rgb(0, 136, 0);">&quot;text/plain&quot;</span><span style="color: rgb(102, 102, 0);">}); //响应头信息</span></div><div style="margin-left:40px;"><span style="color: rgb(0, 0, 0);">  response</span><span style="color: rgb(102, 102, 0);">.</span><span style="color: rgb(0, 0, 0);">write</span><span style="color: rgb(102, 102, 0);">(</span><span style="color: rgb(0, 136, 0);">&quot;Hello World&quot;</span><span style="color: rgb(102, 102, 0);">);  // 响应内容</span></div><div style="margin-left:40px;"><span style="color: rgb(0, 0, 0);">  response</span><span style="color: rgb(102, 102, 0);">.</span><span style="color: rgb(0, 0, 0);">end</span><span style="color: rgb(102, 102, 0);">();</span></div><div style="margin-left:40px;"><span style="color: rgb(102, 102, 0);">}</span></div><div style="margin-left:40px;"><br/></div><div style="margin-left:40px;"><span style="color: rgb(0, 0, 0);">http</span><span style="color: rgb(102, 102, 0);">.</span><span style="color: rgb(0, 0, 0);">createServer</span><span style="color: rgb(102, 102, 0);">(</span><span style="color: rgb(0, 0, 0);">onRequest</span><span style="color: rgb(102, 102, 0);">).</span><span style="color: rgb(0, 0, 0);">listen</span><span style="color: rgb(102, 102, 0);">(</span><span style="color: rgb(0, 102, 102);">8888</span><span style="color: rgb(102, 102, 0);">);</span></div><div style="margin-left:40px;"><br/></div><div style="margin-left:40px;"><span style="color: rgb(0, 0, 0);">console</span><span style="color: rgb(102, 102, 0);">.</span><span style="color: rgb(0, 0, 0);">log</span><span style="color: rgb(102, 102, 0);">(</span><span style="color: rgb(0, 136, 0);">&quot;Server has started.&quot;</span><span style="color: rgb(102, 102, 0);">);</span></div></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">     分析：1.在控制台 node </span></span><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">server.js启动文件以后，控制台会打印 </span></span><span style="color: rgb(0, 136, 0);">Server has started.</span></div><div><span style="color: rgb(0, 136, 0);">                 </span> <span style="font-size: 18px;"><span style="font-family: Georgia;">2.当有浏览器访问localhost:8888时，控制台会打印</span></span> <span style="color: rgb(0, 136, 0);"> </span><span style="color: rgb(0, 136, 0);">Request received，</span><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">浏览器会显示 hello world</span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;"><br/></span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;"><br/></span></span></div><div style="text-align: left; font-size: 18px; margin-bottom: 48px; margin-top: -22px; color: rgb(0, 0, 0); font-family: Georgia, serif; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="margin-left:80px;">当我们与往常一样，运行它<em>node server.js</em>时，它会马上在命令行上输出“Server has started.”。当我们向服务器发出请求（在浏览器访问<a href="http://localhost:8888/" rel="nofollow">http://localhost:8888/</a>），“Request received.”这条消息就会在命令行中出现。</div></div><div style="text-align: left; font-size: 18px; margin-bottom: 48px; margin-top: -22px; color: rgb(0, 0, 0); font-family: Georgia, serif; font-style: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><div style="margin-left:80px;">这就是事件驱动的异步服务器端JavaScript和它的回调啦！</div></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">三、模块化</span></span></div><div><span style="font-size: 18px;"><span style="font-family: Georgia, serif;">              </span></span> <span style="color: rgb(0, 0, 0); font-family: Georgia, serif; font-size: 17.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); display: inline !important; float: none;">把某段代码变成模块意味着我们需要把我们希望提供其功能的部分 </span><em style="color: rgb(0, 0, 0); font-family: Georgia, serif; font-size: 17.6px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">导出</em><span style="color: rgb(0, 0, 0); font-family: Georgia, serif; font-size: 17.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); display: inline !important; float: none;"> 到请求这个模块的脚本。</span></div><div><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">          依赖注入</span></span></span></div><div><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">               把一个模块当做函数的参数传递使用就是依赖注入</span></span></span></div><div><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">          函数式编程</span></span></span></div><div><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">               把函数当做参数传递到另一个函数里面</span></span></span></div><div><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);"><br/></span></span></span></div><div><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">四、并行处理</span></span></span></div><div><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">     </span></span></span>      <span style="color: rgb(0, 0, 0); font-family: Georgia, serif; font-size: 17.6px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); display: inline !important; float: none;">Node.js可以在不新增额外线程的情况下，依然可以对任务进行并行处理 —— Node.js是单线程的。它通过事件轮询（event loop）来实现并行操作，对此，我们应该要充分利用这一点 —— 尽可能的避免阻塞操作，取而代之，多使用非阻塞操作。</span></div><div><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);"><br/></span></span></span></div><div><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">后记：</span></span></span></div><div style="margin-left:40px;"><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">截至为止，按照此书写了一个简单的http请求，包括get，post方法。</span></span></span></div><div style="margin-left:40px;"><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">小demo分三个模块，服务器，路由，请求处理。</span></span></span></div><div style="margin-left:40px;"><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">理解：其实nodejs也是一个库，用require（）去调用nodejs本身的封装好的模块，这次用到的是http（建立），querystring，child_process，url模块。</span></span></span></div><div style="margin-left:40px;"><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">收获：终于明白什么是用js写服务器，就是用js写本来应该是java写的代码。写nodejs必须要锻炼好自己的模块化思维，不然是写不出好的node的。</span></span></span></div><div style="margin-left:40px;"><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">不足：不同路径分配函数的部分，写在index.js里，感觉没有很好的运用模块化思想。</span></span></span></div><div style="margin-left:40px;"><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">               其实这些只是nodejs的冰山一角，只是让我从实例中理解nodejs的使用，但，并不能让我熟练掌握nodejs，所以，这次的练笔是一个开始，以后需要更加多的练笔以及系统学习。</span></span></span></div><div style="margin-left:40px;"><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);">               不明白为什么reponse.write（）不能输出对象值。<br/></span></span></span></div><div style="margin-left:40px;"><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);"><br/></span></span></span></div><div><span style="font-size: 17.6px;"><span style="font-family: Georgia, serif;"><span style="background-color: rgb(255, 255, 255);"><br/></span></span></span></div></div></span>
</div></body></html> 